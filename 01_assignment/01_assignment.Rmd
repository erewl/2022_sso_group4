---
title: "Assignment 1 - Group 4"
author: "Katrin Grunert, Carmen Byrne Salsas, Bono Lardinois"
date: "22 September 2022"
output:
  html_document:
    df_print: paged
fontsize: 11pt
highlight: tango
---

`r weather = read.table("weather.txt",header=TRUE)`
`r birthweight = read.table("birthweight.txt",header=TRUE)`

# Exercise 1.1

## Exercise 1.1.a


The point estimate for the population mean is `r round(mean(birthweight$birthweight), 3)`.

The p-value `r round(shapiro.test(birthweight$birthweight)$p.value, 4)` of the Shapiro-Wilk-Test suggests, that the hypothesis that the data is normally distributed is not rejected. 

QQPlot and Histogram of the data also suggest, that the data is approximately normally distributed


```{r,echo=FALSE,fig.height=3.5}
par(mfrow=c(1,2))
qqnorm(birthweight$birthweight, main="QQPlot of Birthweight")
qqline(birthweight$birthweight, col = "red")
hist(birthweight$birthweight, main="Histogram of Birthweight")
```

## Exercise 1.1.b

```{r,echo=FALSE}
n = nrow(birthweight); mu = mean(birthweight$birthweight); s = sd(birthweight$birthweight)
error_margin = qt(p=(1-0.9)/2,df=n-1, lower.tail = FALSE)*s/sqrt(n)

low = mu - error_margin 
up = mu + error_margin
```

sample size n = `r round(n, 3)`; population $\mu$ = `r round(mu, 3)`; sample standard deviation = `r round(s, 3)`; $\alpha$ = 0.05 (90% CI two-sided)

The 90% Confidence interval has the lower and upper bounds of [`r round(low, 3)`, `r round(up, 3)`], meaning we can say with 90% confidence that the population mean lies between these values. 

## Exercise 1.1.c
```{r}
t.test(birthweight$birthweight, mu = 2800, alternative = "greater")
```

## Exercise 1.1.d
The Student T-Test from Exercise 1.1.c is one-sided, because we were interested whether the birthweight mean is bigger than 2800, resulting in a right-tailed and not a two-sided test.


# Exercise 1.2
## Exercise 1.2.a
## Exercise 1.2.b
## Exercise 1.2.c
## Exercise 1.2.d


# Exercise 1.3
## Exercise 1.3.a
```{r}
summary(weather$humidity)
summary(weather$temperature)
```

```{r,echo=FALSE,fig.height=3.5}
par(mfrow=c(1,2))
boxplot(weather$humidity, main='Boxplot of Humidity')
boxplot(weather$temperature, main='Boxplot of Temperature')
```
Summary and boxplot of the temperature data show a greater range of values (see Min and Max values)
In both summaries of humidity and temperature, no severe outliers can be found, as Mean and Median are close to each other and no outliers are being displayed in the boxplots.

When plotting both data in a scatterplot (below), no clear correlation can be found between humidity and temperature.

```{r,echo=FALSE,fig.height=4.5, fig.width=4.5}
par(mfrow=c(1,1))
plot(weather$humidity, weather$temperature, xlab='Humidity', ylab="Temperature", main="Scatterplot of HumidityxTemperature")
```


## Exercise 1.3.b

Histogram and QQPlot of the temperature data suggest that the data is not normally distributed, neither a clear bell curve can be drawn into the histogram, nor a straight line can be fitted to approximately all data points in the QQPlot.

```{r,echo=FALSE,fig.height=3.5}
par(mfrow=c(1,2))
hist(weather$temperature, main = 'Histogram of Temperature')
qqnorm(weather$temperature, main = 'QQPlot of Temperature')
qqline(weather$temperature, col = "red")
```


## Exercise 1.3.c

```{r,echo=FALSE}
n = nrow(weather); mu = mean(weather$temperature); s = sd(weather$temperature)
error_margin = qt((1-0.90)/2,df=n-1, lower.tail=FALSE)*s/sqrt(n)

low = mu - error_margin 
up = mu + error_margin
```

Assuming normality of the data, we can say with 90% confidence that the mean temperature of the population lays in the range of [`r round(low,3)`, `r round(up, 3)`]

## Exercise 1.3.d
For a large sample size $n$, a t-statistic at a significance level $\alpha$ can be approximated by a z-statistic. In our case, this is a necessary step since the sample size is unknown; therefore, we cannot specify in advance the degrees of freedom of the t-statistic. 

By the central limit theorem, the sample mean is normally distributed. Thus, the formula for a 95% confidence interval around the mean $\mu$  with standard deviation $\sigma$ is: 
$\mu \pm E$, where E is the margin of error defined as $E = z_{\alpha/2} \frac{\sigma}{\sqrt n}$. 

For a large sample size, the population standard deviation $\sigma$ is approximately equal to the sample standard deviation $s$. Solving for $n$, we find the following expression for the minimum sample size for a confidence interval of length $2 E$ at a significance level $\alpha$:

$n \geq \frac{(z_{\alpha/2} s)^2}{E^2}$

```{r}
ci_length = 2
E = ci_length/2
alpha = 0.05
z_stat = qnorm(alpha/2, lower.tail=FALSE)
s_humidity = sd(weather$humidity)
n = (z_stat^2)*(s_humidity^2)/E^2
```

Thus, the minimum sample size for a 95% confidence interval for the mean humidity with maximum length 2% is `r ceiling(n)`.


# Exercise 1.4
## Exercise 1.4.a
Since the admirer attempts to imitate Austen's writing style, the contingency table test for homogeneity seems a fitting choice. Generalized, the contingency table test for homogeneity explores whether two datasets are originating from the same population, this maps well to the intention of the admirer.

## Exercise 1.4.b
## Exercise 1.4.c
## Exercise 1.4.d